<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ospsuite.reportingengine">
<title>Plot settings • ospsuite.reportingengine</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot settings">
<meta property="og:description" content="ospsuite.reportingengine">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ospsuite.reportingengine</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/ospsuite-reportingengine.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/add-title-page.html">Add a title page to your workflow report</a>
    <a class="dropdown-item" href="../articles/demography.html">Demography Parameters in Population Workflows</a>
    <a class="dropdown-item" href="../articles/excel-template.html">Excel Template</a>
    <a class="dropdown-item" href="../articles/goodness-of-fit.html">Time profiles and Residuals task</a>
    <a class="dropdown-item" href="../articles/mass-balance.html">Mass Balance</a>
    <a class="dropdown-item" href="../articles/pk-parameters.html">PK parameters</a>
    <a class="dropdown-item" href="../articles/plot-settings.html">Plot settings</a>
    <a class="dropdown-item" href="../articles/pop-pk-parameters.html">PK Parameters in Population Workflows</a>
    <a class="dropdown-item" href="../articles/qualification-workflow.html">Qualification Workflow</a>
    <a class="dropdown-item" href="../articles/sensitivity-analysis.html">Sensitivity Analysis</a>
    <a class="dropdown-item" href="../articles/word-report.html">How to work with word reports</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/open-systems-pharmacology/ospsuite.reportingengine/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plot settings</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/open-systems-pharmacology/ospsuite.reportingengine/blob/HEAD/vignettes/plot-settings.Rmd" class="external-link"><code>vignettes/plot-settings.Rmd</code></a></small>
      <div class="d-none name"><code>plot-settings.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/open-systems-pharmacology/ospsuite.reportingengine" class="external-link">ospsuite.reportingengine</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ospsuite.reportingengine</span></span>
<span><span class="co">#&gt; Loading required package: ospsuite</span></span>
<span><span class="co">#&gt; Loading required package: rSharp</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'ospsuite'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     %||%</span></span>
<span><span class="co">#&gt; Loading required package: tlf</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette provides some guidance to define properties and
settings for the reporting engine.</p>
<p>These properties can at 2 levels:</p>
<ul>
<li>Global or workflow plot configuration, affecting every plot of the
workflow output</li>
<li>Local or task plot configuration, affecting specific plots within a
task</li>
</ul>
</div>
<div class="section level2">
<h2 id="how-to-set-global-workflow-properties">How to set global workflow properties<a class="anchor" aria-label="anchor" href="#how-to-set-global-workflow-properties"></a>
</h2>
<p>Reporting Engine global setting names are listed in the enum <a href="../reference/reSettingsNames.html"><code>reSettingsNames</code></a>.
Each global setting can be reviewed using the function
<code><a href="../reference/getRESettings.html">getRESettings()</a></code>.</p>
<p>It is possible to update, save and reuse most of the reporting engine
default settings using the functions available in the section <a href="../reference/index.html#default-settings"><strong>Default
Settings</strong></a>.</p>
<p>Note that the function <code><a href="../reference/resetRESettingsToDefault.html">resetRESettingsToDefault()</a></code> allows
you to reset to initial default values defined by the reporting
engine.</p>
<div class="section level3">
<h3 id="notion-of-theme">Notion of theme<a class="anchor" aria-label="anchor" href="#notion-of-theme"></a>
</h3>
<p>A theme is an object of R6 class <code>Theme</code> which defines the
default properties used to build every plot in <code>tlf</code> package.
More information can be found directly within the documentation of the
the <code>tlf</code> package (vignettes <strong>“theme-maker”</strong>
and <strong>“plot-configuration”</strong>).</p>
<p>The best workflow to set a <code>Theme</code> object is to use json
files. Templates of json files are available in the <code>tlf</code>
package at the location defined below:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the path of the Json template</span></span>
<span><span class="va">jsonFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"re-theme.json"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"ospsuite.reportingengine"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the theme from the json file</span></span>
<span><span class="va">reTheme</span> <span class="op">&lt;-</span> <span class="fu">tlf</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tlf/man/loadThemeFromJson.html" class="external-link">loadThemeFromJson</a></span><span class="op">(</span><span class="va">jsonFile</span><span class="op">)</span></span></code></pre></div>
<p>Modifications of the theme properties can be done directly by
updating the properties of the <code>Theme</code> object as shown
below:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Overwrite the current background fill</span></span>
<span><span class="va">reTheme</span><span class="op">$</span><span class="va">background</span><span class="op">$</span><span class="va">panel</span><span class="op">$</span><span class="va">fill</span> <span class="op">&lt;-</span> <span class="st">"white"</span></span>
<span><span class="va">reTheme</span><span class="op">$</span><span class="va">background</span><span class="op">$</span><span class="va">panel</span><span class="op">$</span><span class="va">fill</span></span>
<span><span class="co">#&gt; [1] "white"</span></span></code></pre></div>
<p>To save the updated <code>Theme</code> object, the function
<code>saveThemeToJson</code> provided by <code>tlf</code> package can be
used.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save your updated theme in "my-new-theme.json"</span></span>
<span><span class="fu">tlf</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tlf/man/saveThemeToJson.html" class="external-link">saveThemeToJson</a></span><span class="op">(</span><span class="st">"my-new-theme.json"</span>, theme <span class="op">=</span> <span class="va">reTheme</span><span class="op">)</span></span></code></pre></div>
<p>In addition, the <code>tlf</code> package provides a Shiny app to
define and save your own theme with a few clicks:
<strong><code><a href="https://rdrr.io/pkg/tlf/man/runThemeMaker.html" class="external-link">tlf::runThemeMaker()</a></code></strong>.</p>
<p>Then, the most important step is to define the <code>Theme</code>
object as the current default for the workflow. In
<code>ospsuite.reportingengine</code>, this can be either achieved using
the function <code>setDefaultTheme</code> with a <code>Theme</code>
object as shown in the example below with
<strong><code>reTheme</code></strong>.</p>
<p>The properties defined by the <code>Theme</code> object will be used
by default if no specific plot configurations are provided for the
workflow plots.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set reTheme as current default Theme</span></span>
<span><span class="fu"><a href="../reference/setDefaultTheme.html">setDefaultTheme</a></span><span class="op">(</span><span class="va">reTheme</span><span class="op">)</span></span></code></pre></div>
<p><strong>Caution</strong>: loading a workflow re-initialize the
default theme. The function <code><a href="../reference/setDefaultTheme.html">setDefaultTheme()</a></code> needs to be
called after initialization of the workflow.</p>
<p>Additionally, <code>Workflow</code> objects have a <code>theme</code>
input argument available in method <code>$new()</code> to use the input
theme instead of the reporting engine default.</p>
</div>
<div class="section level3">
<h3 id="exporting-plots-in-a-specific-format">Exporting plots in a specific format<a class="anchor" aria-label="anchor" href="#exporting-plots-in-a-specific-format"></a>
</h3>
<p>One important global setting is the format of the figure files
(e.g. png, jpg or pdf) as well as the quality of the figures. By
default, the figures are saved as png files with a size of 20 x 15 cm.
The format settings can be managed using the function
<strong><code><a href="../reference/setDefaultPlotFormat.html">setDefaultPlotFormat()</a></code></strong> as illustrated
below, input arguments are <code>format</code>, <code>width</code>,
<code>height</code>, their <code>units</code> and the plot resolution
<code>dpi</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/setDefaultPlotFormat.html">setDefaultPlotFormat</a></span><span class="op">(</span>format <span class="op">=</span> <span class="st">"png"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="watermark">Watermark<a class="anchor" aria-label="anchor" href="#watermark"></a>
</h3>
<p>Watermark corresponds to text in the background of plots. Watermark
font properties can be set in the <code>Theme</code> object:
<code>reTheme$fonts$watermark</code>.</p>
<p>Regarding the content of the watermark, the default content available
in the <code>Theme</code> object (i.e. at
<code>reTheme$background$watermark</code> in the example) is overwritten
by the <code>Workflow</code> objects:</p>
<ul>
<li>If a system is validated, no text is printed in background by
default.</li>
<li>If a system is <strong>NOT</strong> validated, the text
<strong><em>“preliminary results”</em></strong> is printed in background
by default.</li>
</ul>
<p>As a consequence, setting the watermark content needs to be performed
directly with the <code>Workflow</code> objects: either when
initializing the workflow using the input argument
<code>watermark</code>
(e.g. <code>MeanModelWorkflow$new(..., watermark = "vignette example")</code>);
or using the workflow method
<strong><code>$setWatermark(watermark)</code></strong>
(e.g. <code>myWorkflow$setWatermark("vignette example")</code>).</p>
<p>The workflow method <strong><code>$getWatermark()</code></strong>
prints the watermark text which will be in the background of the figures
output by the workflow
(e.g. <code>myWorkflow$getWatermark()</code>).</p>
<p><strong>Note</strong>: The <strong>NULL</strong> input argument for
watermark leads to using the default watermark feature.</p>
</div>
</div>
<div class="section level2">
<h2 id="how-to-set-task-specific-properties">How to set task specific properties<a class="anchor" aria-label="anchor" href="#how-to-set-task-specific-properties"></a>
</h2>
<p>Each task of <code>Workflow</code> objects includes a field named
<strong><code>settings</code></strong>. This optional field of class
<code>TaskSettings</code> can be updated and will overwrite the default
behavior of a task.</p>
<p>Two usual subfields of <strong><code>settings</code></strong> are:
<strong><code>plotConfigurations</code></strong> and
<strong><code>bins</code></strong>. Other settings can also be provided
and will be detailed in the next sections.</p>
<ul>
<li>
<strong><code>plotConfigurations</code></strong> is a list of
<code>PlotConfiguration</code> objects from the <code>tlf</code>
package. <code>PlotConfiguration</code> is an R6 class in which plot
properties are stored and used to create plots with a desired
configuration. More information can be found on this notion within the
<code>tlf</code> vignette <strong>“plot-configuration”</strong>.
Providing a user-defined <code>PlotConfiguration</code> object to this
input list will overwrite the default configuration and will be used to
generate the task corresponding task plot(s).</li>
<li>
<strong><code>bins</code></strong> can be a number, a vector or a
function which will be used to bin histograms.</li>
</ul>
<p>The next section will provide the names of the plots and options that
can be accessed through the field
<strong><code>settings</code></strong>.</p>
<div class="section level3">
<h3 id="time-profiles-and-residuals">Time profiles and residuals<a class="anchor" aria-label="anchor" href="#time-profiles-and-residuals"></a>
</h3>
<p>Regardless of the workflow subclass (<code>MeanModelWorkflow</code>
or <code>PopulationWorkflow</code>), the names in the
<strong><code>plotConfigurations</code></strong> list available for the
<strong>“plotTimeProfilesAndResiduals”</strong> task are the
following:</p>
<ul>
<li>
<strong>“timeProfile”</strong>: for time profile plots in linear and
log scale</li>
<li>
<strong>“obsVsPred”</strong>: for observed vs simulated data in
linear and log scale</li>
<li>
<strong>“resVsPred”</strong>: for residuals vs simulated data
plots</li>
<li>
<strong>“resVsTime”</strong>: for residuals vs time plots</li>
<li>
<strong>“resHisto”</strong>: for histograms of residuals</li>
<li>
<strong>“resQQPlot”</strong>: for qq-plots of residuals</li>
<li>
<strong>“histogram”</strong>: for histograms of residuals across all
simulations</li>
<li>
<strong>“qqPlot”</strong>: for qq-plots of residuals across all
simulations</li>
</ul>
<p>Since histograms are performed by the task,
<strong><code>bins</code></strong> can also be defined.</p>
<p>Displayed names and units are usually managed through the
<strong><code>SimulationSet</code></strong> and
<strong><code>Output</code></strong> objects. The vignette
<strong>“goodness-of-fit”</strong> provides more details about the
<strong>“plotTimeProfilesAndResiduals”</strong> task.</p>
<p><strong>Example</strong>: below shows a typical mean model workflow
example in which <strong><code>plotConfigurations</code></strong> and
<strong><code>bins</code></strong> are set for a
<strong>“plotTimeProfilesAndResiduals”</strong> task.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the pkml simulation file: "MiniModel2.pkml"</span></span>
<span><span class="va">simulationFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"MiniModel2.pkml"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"ospsuite.reportingengine"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the output object</span></span>
<span><span class="va">outputA</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Output.html">Output</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="st">"Organism|A|Concentration in container"</span>,</span>
<span>  displayName <span class="op">=</span> <span class="st">"Simulated concentration of A"</span>,</span>
<span>  displayUnit <span class="op">=</span> <span class="st">"µmol/ml"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the simulation set object</span></span>
<span><span class="va">setA</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/SimulationSet.html">SimulationSet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  simulationSetName <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>  simulationFile <span class="op">=</span> <span class="va">simulationFile</span>,</span>
<span>  outputs <span class="op">=</span> <span class="va">outputA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the workflow object</span></span>
<span><span class="va">workflowA</span> <span class="op">&lt;-</span></span>
<span>  <span class="va"><a href="../reference/MeanModelWorkflow.html">MeanModelWorkflow</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    simulationSets <span class="op">=</span> <span class="va">setA</span>,</span>
<span>    workflowFolder <span class="op">=</span> <span class="st">"Example-A"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; 05/07/2024 - 12:38:55</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00; font-weight: bold;">i Info  </span>Reporting Engine Information:</span></span>
<span><span class="co">#&gt;  Date: 05/07/2024 - 12:38:55</span></span>
<span><span class="co">#&gt;  User Information:</span></span>
<span><span class="co">#&gt;  Computer Name: fv-az586-783</span></span>
<span><span class="co">#&gt;  User: runneradmin</span></span>
<span><span class="co">#&gt;  Login: runneradmin</span></span>
<span><span class="co">#&gt;  System is NOT validated</span></span>
<span><span class="co">#&gt;  System versions:</span></span>
<span><span class="co">#&gt;  R version: R version 4.4.1 (2024-06-14 ucrt)</span></span>
<span><span class="co">#&gt;  OSP Suite Package version: 12.0.1088</span></span>
<span><span class="co">#&gt;  OSP Reporting Engine version: 2.2</span></span>
<span><span class="co">#&gt;  tlf version: 1.5.168</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set the workflow tasks to be run</span></span>
<span><span class="va">workflowA</span><span class="op">$</span><span class="fu">activateTasks</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"simulate"</span>, <span class="st">"plotTimeProfilesAndResiduals"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The next chunk of code will define <code>PlotConfiguration</code>
objects to be included in <strong><code>settings</code></strong>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define plot configuration for obsVsPred</span></span>
<span><span class="va">obsVsPredConfiguration</span> <span class="op">&lt;-</span> <span class="va">PlotConfiguration</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  xlabel <span class="op">=</span> <span class="st">"Observed values [µmol/ml]"</span>,</span>
<span>  ylabel <span class="op">=</span> <span class="st">"Simulated values [µmol/ml]"</span>,</span>
<span>  watermark <span class="op">=</span> <span class="st">"vignette"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define plot configuration for resHisto</span></span>
<span><span class="va">resHistoConfiguration</span> <span class="op">&lt;-</span> <span class="va">PlotConfiguration</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  xlabel <span class="op">=</span> <span class="st">"Residuals"</span>,</span>
<span>  ylabel <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>  watermark <span class="op">=</span> <span class="st">"vignette"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Update some fields of the configuration if necessary</span></span>
<span><span class="va">resHistoConfiguration</span><span class="op">$</span><span class="va">background</span><span class="op">$</span><span class="va">plot</span><span class="op">$</span><span class="va">fill</span> <span class="op">&lt;-</span> <span class="st">"lemonchiffon"</span></span>
<span><span class="va">resHistoConfiguration</span><span class="op">$</span><span class="va">background</span><span class="op">$</span><span class="va">panel</span><span class="op">$</span><span class="va">fill</span> <span class="op">&lt;-</span> <span class="st">"lemonchiffon"</span></span>
<span><span class="va">resHistoConfiguration</span><span class="op">$</span><span class="va">background</span><span class="op">$</span><span class="va">panel</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="st">"goldenrod3"</span></span>
<span><span class="va">resHistoConfiguration</span><span class="op">$</span><span class="va">background</span><span class="op">$</span><span class="va">xGrid</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="st">"goldenrod3"</span></span>
<span><span class="va">resHistoConfiguration</span><span class="op">$</span><span class="va">background</span><span class="op">$</span><span class="va">yGrid</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="st">"goldenrod3"</span></span>
<span></span>
<span><span class="co"># Define plotConfigurations list</span></span>
<span><span class="va">plotConfigurations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  resHisto <span class="op">=</span> <span class="va">resHistoConfiguration</span>,</span>
<span>  obsVsPred <span class="op">=</span> <span class="va">obsVsPredConfiguration</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define list to update task settings with plotConfigurations field and and bins field</span></span>
<span><span class="va">mySettings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  plotConfigurations <span class="op">=</span> <span class="va">plotConfigurations</span>,</span>
<span>  bins <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then, the <strong><code>settings</code></strong> field of the
<strong>“plotTimeProfilesAndResiduals”</strong> task can be updated as
shown below:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the workflow</span></span>
<span><span class="va">workflowA</span><span class="op">$</span><span class="va">plotTimeProfilesAndResiduals</span><span class="op">$</span><span class="va">settings</span> <span class="op">&lt;-</span> <span class="va">mySettings</span></span></code></pre></div>
<p>The run of the workflow with updated settings and get the resulting
report as shown below.</p>
<p>Since the histogram across the all simulations did not get the plot
configuration settings defined for individual simulations, the plots are
quite different. However, the option <strong><code>bins</code></strong>
is currently set among all plots of the task. Regarding observed vs
simulated plots, the got the updated xlabel, ylabel and watermark as
defined in the plot configuration.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the workflow</span></span>
<span><span class="va">workflowA</span><span class="op">$</span><span class="fu">runWorkflow</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; 05/07/2024 - 12:38:55</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00; font-weight: bold;">i Info  </span>Starting run of <span style="color: #00BBBB; font-weight: bold; font-style: italic;">Mean Model Workflow</span></span></span>
<span><span class="co">#&gt; 05/07/2024 - 12:38:55</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00; font-weight: bold;">i Info  </span>Starting run of <span style="color: #00BBBB; font-weight: bold; font-style: italic;">Simulation task</span></span></span>
<span><span class="co">#&gt; 05/07/2024 - 12:38:56</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00; font-weight: bold;">i Info  </span>Splitting simulations for parallel run: <span style="color: #00BBBB; font-weight: bold; font-style: italic;">1</span> simulations split into <span style="color: #00BBBB; font-weight: bold; font-style: italic;">1</span> subsets</span></span>
<span><span class="co">#&gt; 05/07/2024 - 12:38:56</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00; font-weight: bold;">i Info  </span>Starting run of <span style="color: #00BBBB; font-weight: bold; font-style: italic;">subset simulations</span></span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; 05/07/2024 - 12:38:56</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00; font-weight: bold;">i Info  </span><span style="color: #00BBBB; font-weight: bold; font-style: italic;">Simulation task</span> completed in 0 min</span></span>
<span><span class="co">#&gt; 05/07/2024 - 12:38:56</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00; font-weight: bold;">i Info  </span>Starting run of <span style="color: #00BBBB; font-weight: bold; font-style: italic;">Plot Time profiles and Residuals task</span></span></span>
<span><span class="co">#&gt; 05/07/2024 - 12:38:56</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00; font-weight: bold;">i Info  </span>Starting run of <span style="color: #00BBBB; font-weight: bold; font-style: italic;">Plot Time profiles and Residuals task</span> for <span style="color: #00BBBB; font-weight: bold; font-style: italic;">A</span></span></span>
<span><span class="co">#&gt; 05/07/2024 - 12:38:58</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00; font-weight: bold;">i Info  </span><span style="color: #00BBBB; font-weight: bold; font-style: italic;">Plot Time profiles and Residuals task</span> completed in 0 min</span></span>
<span><span class="co">#&gt; 05/07/2024 - 12:38:58</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00; font-weight: bold;">i Info  </span>Executing: pandoc --embed-resources --standalone --wrap=none --toc --from=markdown+tex_math_dollars+superscript+subscript+raw_attribute --reference-doc="C:/Users/runneradmin/AppData/Local/Temp/RtmpacpagG/temp_libpath19187f356d9d/ospsuite.reportingengine/extdata/reference.docx" --resource-path="Example-A" -t docx -o "Example-A/Report-word.docx" "Example-A/Report-word.md"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 05/07/2024 - 12:38:58</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00; font-weight: bold;">i Info  </span><span style="color: #00BBBB; font-weight: bold; font-style: italic;">Mean Model Workflow</span> completed in 0 min</span></span></code></pre></div>
<details><summary><strong>Report</strong>
</summary><img src="figures/report-snapshot-64.png" style="width:100%; border-style: none;"></details>
</div>
<div class="section level3">
<h3 id="pk-parameters-plots">PK parameters plots<a class="anchor" aria-label="anchor" href="#pk-parameters-plots"></a>
</h3>
<p>Selection, displayed names and units are usually managed through the
<code>ospsuite</code> <strong><code>PKParameters</code></strong> objects
or <strong><code>PkParametersInfo</code></strong> objects. The vignette
<strong>“pk-parameters”</strong> provides more details about the
<strong>“plotPKParameters”</strong> task.</p>
<p>For mean model workflows, the PK parameters are only summarized as
tables. In the current version, there is no option for number of decimal
numbers to set.</p>
<p>For population workflows, the parameters are described using plots
which depends on the population workflow type. The names in the
<strong><code>plotConfigurations</code></strong> list available for the
<strong>“plotPKParameters”</strong> task are the following:</p>
<ul>
<li>
<strong>“boxplotPkParameters”</strong>: for boxplots of PK
parameters performed by parallel comparison and ratio types of
population workflows</li>
<li>
<strong>“boxplotPkRatios”</strong>: for boxplots of PK parameters
ratios performed by ratio type of population workflows</li>
<li>
<strong>“vpcParameterPlot”</strong>: for VPC like plots of PK
parameters vs Demography parameters performed by pediatric type of
population workflows</li>
<li>
<strong>“comparisonVpcPlot”</strong>: for VPC like plots of PK
parameters vs Demography parameters comparing to reference population
performed by pediatric type</li>
</ul>
<p>Since pediatric workflows perform VPC like plot, aggregation of the
data is performed along the demography parameters. The binning of the
demography parameters can be set by the optional field
<strong><code>bins</code></strong> from the task field
<strong><code>settings</code></strong>. This field can be either a
unique value corresponding to the number of bins or a vector defining
the bin edges for all the demography parameter paths.</p>
<p>Besides, the final plot can either link the aggregated values or plot
them as stairstep. The default behaviour is to perform a stairstep plot,
but this can be tuned with the optional field
<strong><code>stairstep</code></strong>
(<code>TRUE</code>/<code>FALSE</code>) from the task field
<strong><code>settings</code></strong>.</p>
<p>Below shows examples of how to set such options:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Associate the bin edges</span></span>
<span><span class="va">workflowA</span><span class="op">$</span><span class="va">plotPKParameters</span><span class="op">$</span><span class="va">settings</span><span class="op">$</span><span class="va">bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Associate the number of bins</span></span>
<span><span class="va">workflowA</span><span class="op">$</span><span class="va">plotPKParameters</span><span class="op">$</span><span class="va">settings</span><span class="op">$</span><span class="va">bins</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span></span>
<span><span class="co"># Set VPC as stair step</span></span>
<span><span class="va">workflowA</span><span class="op">$</span><span class="va">plotPKParameters</span><span class="op">$</span><span class="va">settings</span><span class="op">$</span><span class="va">stairstep</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sensitivity-plots">Sensitivity plots<a class="anchor" aria-label="anchor" href="#sensitivity-plots"></a>
</h3>
<p>Settings for the sensitivity plots are
<strong><code>SensitivityPlotSettings</code></strong> objects. The
vignette <strong>“sensitivity-analysis”</strong> provides more details
about the <strong>“plotSensitivity”</strong> task.</p>
<p>The input argument of the
<strong><code>SensitivityPlotSettings</code></strong> settings object
are then (to be created using
<code>SensitivityPlotSettings$new()</code>):</p>
<ul>
<li>
<strong><code>totalSensitivityThreshold</code></strong>: cut-off
used for plots of the most sensitive parameters; default is
<strong>0.9</strong>.</li>
<li>
<strong><code>variableParameterPaths</code></strong>: paths that
were varied in the sensitivity analysis. If supplied
<strong><code>totalSensitivityThreshold</code></strong> is 1, else it
uses the default or user-provided value.</li>
<li>
<strong><code>maximalParametersPerSensitivityPlot</code></strong>:
maximal number of parameters to display in a sensitivity plot. By
default, the maximal number of parameters to display is
<strong>50</strong>.</li>
<li>
<strong><code>plotConfiguration</code></strong>:
<code>PlotConfiguration</code> object from <code>tlf</code> library</li>
<li>
<strong><code>xAxisFontSize</code></strong>: Font size of x-axis
labels for sensitivity plot, that can overwrite behavior of
<strong><code>plotConfiguration</code></strong>. Default font size is
6.</li>
<li>
<strong><code>yAxisFontSize</code></strong>: Font size of y-axis
labels for sensitivity plot, that can overwrite behavior of
<strong><code>plotConfiguration</code></strong>. Default font size is
6.</li>
<li>
<strong><code>xLabel</code></strong> Label of x-axis for sensitivity
plot, that can overwrite behavior of
<strong><code>plotConfiguration</code></strong>. Default xLabel is
<strong>“Sensitivity”</strong>.</li>
<li>
<strong><code>yLabel</code></strong> Label of y-axis for sensitivity
plot, that can overwrite behavior of
<strong><code>plotConfiguration</code></strong>. Default yLabel is
<strong>NULL</strong>.</li>
<li>
<strong><code>colorPalette</code></strong> Name of a color palette
to be used by <code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">ggplot2::scale_fill_brewer()</a></code> for sensitivity
plot. Default color palette is <strong>“Spectral”</strong>.</li>
</ul>
<p>Since displayed sensitivity parameters can include long strings of
characters shrinking the actual plot even using small
<code>yAxisFontSize</code>, an algorithm providing line breaks is
included in the task to prevent the shrinking issue as much as possible.
Two fields are available in settings to tune the algorithm:</p>
<ul>
<li>
<strong><code>maxWidthPerParameter</code></strong> is the maximum
width for the display parameters. Parameters longer than that will have
line breaks. The default maximum width is 25 characters.</li>
<li>
<strong><code>maxLinesPerParameter</code></strong> is the maximum
number of lines for the display parameters. The default maximum number
of lines is 3. For parameters longer than
<code>maxLinesPerParameter*maxWidthPerParameter</code>, only
<code>maxLinesPerParameter</code> setting will be respected.</li>
</ul>
</div>
<div class="section level3">
<h3 id="absorption">Absorption<a class="anchor" aria-label="anchor" href="#absorption"></a>
</h3>
<p>The name in the <strong><code>plotConfigurations</code></strong> list
available for the <strong>“plotAbsorption”</strong> task is the
following:</p>
<ul>
<li><strong>“absorptionPlot”</strong></li>
</ul>
</div>
<div class="section level3">
<h3 id="mass-balance">Mass Balance<a class="anchor" aria-label="anchor" href="#mass-balance"></a>
</h3>
<p>The name in the <strong><code>plotConfigurations</code></strong> list
available for the <strong>“plotMassBalance”</strong> task is the
following:</p>
<ul>
<li>
<strong>“timeProfile”</strong>: for time profile plots of mass
balance in linear and log scales</li>
<li>
<strong>“cumulativeTimeProfile”</strong>: for cumulative time
profile plots of mass balance in linear and log scales</li>
<li>
<strong>“normalizedTimeProfile”</strong>: for normalized time
profile plots (as fraction of drug mass) of mass balance in linear and
log scales</li>
<li>
<strong>“normalizedCumulativeTimeProfile”</strong>: for cumulative
normalized time profile plots of mass balance in linear and log
scales</li>
<li>
<strong>“pieChart”</strong>: for pie chart of mass balance at last
simulated time point</li>
</ul>
<p>Another field of <strong><code>settings</code></strong> is
<strong><code>selectedCompoundNames</code></strong> which allows to keep
only a selected list of compounds to be kept in the mass balance
plots.</p>
</div>
<div class="section level3">
<h3 id="demography-plots">Demography plots<a class="anchor" aria-label="anchor" href="#demography-plots"></a>
</h3>
<p>The names in the <strong><code>plotConfigurations</code></strong>
list available for the <strong>“plotDemography”</strong> task are the
following:</p>
<ul>
<li>
<strong>“histogram”</strong>: for histogram of Demography parameters
performed by parallel comparison and ratio types of population
workflows</li>
<li>
<strong>“vpcParameterPlot”</strong>: for VPC like plots of
Demography parameters vs Demography parameters performed by pediatric
type of population workflows</li>
<li>
<strong>“comparisonVpcPlot”</strong>: for VPC like plots of
Demography parameters vs Demography parameters comparing to reference
population performed by pediatric type</li>
</ul>
<p>Since pediatric workflows perform VPC like plot, aggregation of the
data is performed along the demography parameters. The binning of the
demography parameters can be set by the optional field
<strong><code>bins</code></strong> from the task field
<strong><code>settings</code></strong>. This field can be either a
unique value corresponding to the number of bins or a vector defining
the bin edges for all the demography parameter paths.</p>
<p>Besides, the final plot can either link the aggregated values or plot
them as stairstep. The default behaviour is to perform a stairstep plot,
but this can be tuned with the optional field
<strong><code>stairstep</code></strong>
(<code>TRUE</code>/<code>FALSE</code>) from the task field
<strong><code>settings</code></strong>.</p>
<p>Similarly, parallel comparison and ratio types of population
workflows perform histograms, whose binning can set using the
<strong><code>settings</code></strong> field
<strong><code>bins</code></strong>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Sevestre, Juri Solodenko, Pierre Chelle, Abdullah Hamadeh.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
