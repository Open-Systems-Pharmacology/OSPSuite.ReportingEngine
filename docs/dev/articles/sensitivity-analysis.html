<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ospsuite.reportingengine">
<title>Sensitivity Analysis • ospsuite.reportingengine</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sensitivity Analysis">
<meta property="og:description" content="ospsuite.reportingengine">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ospsuite.reportingengine</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/ospsuite-reportingengine.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/add-title-page.html">Add a title page to your workflow report</a>
    <a class="dropdown-item" href="../articles/demography.html">Demography Parameters in Population Workflows</a>
    <a class="dropdown-item" href="../articles/excel-template.html">Excel Template</a>
    <a class="dropdown-item" href="../articles/goodness-of-fit.html">Time profiles and Residuals task</a>
    <a class="dropdown-item" href="../articles/mass-balance.html">Mass Balance</a>
    <a class="dropdown-item" href="../articles/pk-parameters.html">PK parameters</a>
    <a class="dropdown-item" href="../articles/plot-settings.html">Plot settings</a>
    <a class="dropdown-item" href="../articles/pop-pk-parameters.html">PK Parameters in Population Workflows</a>
    <a class="dropdown-item" href="../articles/qualification-workflow.html">Qualification Workflow</a>
    <a class="dropdown-item" href="../articles/sensitivity-analysis.html">Sensitivity Analysis</a>
    <a class="dropdown-item" href="../articles/word-report.html">How to work with word reports</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/open-systems-pharmacology/ospsuite.reportingengine/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Sensitivity Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/open-systems-pharmacology/ospsuite.reportingengine/blob/HEAD/vignettes/sensitivity-analysis.Rmd" class="external-link"><code>vignettes/sensitivity-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>sensitivity-analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The sensitivity task aims at generating plots showing PK parameter
sensitivity to variations of model input parameters. This vignette
presents example workflows for setting up, evaluating and visualizing
sensitivity analyses for both a mean model and a population.</p>
<div class="section level3">
<h3 id="inputs-files-required-for-sensitivity-analysis">Inputs files required for sensitivity analysis<a class="anchor" aria-label="anchor" href="#inputs-files-required-for-sensitivity-analysis"></a>
</h3>
<p>The only input file required for running a sensitivity analysis on a
mean model is the <code>.pkml</code> simulation file. The path to this
file (either the absolute path or the relative path with respect to the
<code>workflowFolder</code> directory) is specified as a string:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulationFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"caffeine-simulation.pkml"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"ospsuite.reportingengine"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For population sensitivity analyses, the user needs to similarly
specify paths to <code>.csv</code> files containing data on the
populations to be studied:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">populationFile1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pop1.csv"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"ospsuite.reportingengine"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">populationFile2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pop2.csv"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"ospsuite.reportingengine"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Results obtained from the <code>calculateSensitivity</code> task are
stored as csv files within the <code>SensitivityResults</code>
subdirectory of the <code>workflowFolder</code> directory. These results
are required in order to perform the <code>plotSensitivity</code> task,
which generates plots of the sensitivity analysis results.</p>
<!-- As a consequence, if the workflow output folder does not include the appropriate simulations, the task `calculateSensitivity` needs to be __active__.

The objects `SimulationSet` (or `PopulationSimulationSet` for population workflows) and `Output` define which and how the simulated PK parameters will be reported. -->
</div>
<div class="section level3">
<h3 id="specification-of-quantities-analyzed-model-outputs-and-pk-parameters">Specification of quantities analyzed: model outputs and PK
parameters<a class="anchor" aria-label="anchor" href="#specification-of-quantities-analyzed-model-outputs-and-pk-parameters"></a>
</h3>
<p>A sensitivity analysis will compute the variation in a scalar
function of a time-series trajectory of a model output in response to
variations in model variables. The model outputs are specified using
paths to simulated quantities within the model. The scalar functions are
PK parameter quantities such as <code>C_max</code> or <code>AUC</code>.
Although the sensitivity analysis for a mean model or an individual
within a population is evaluated for all PK parameters, the user has the
option of specifying the subset of PK parameters for which sensitivity
plots are to be generated. In addition, the user has the option to set
custom display names for both the selected model outputs and PK
parameters used in the sensitivity analysis.</p>
<p>Sets of output and PK parameter combinations for the sensitivity
analysis are defined as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output1</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Output.html">Output</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="st">"Organism|Lung|Interstitial|Caffeine|Concentration"</span>, displayName <span class="op">=</span> <span class="st">"op1"</span>,</span>
<span>  pkParameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va"><a href="../reference/PkParameterInfo.html">PkParameterInfo</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"C_max"</span>, <span class="st">"new_C_max"</span><span class="op">)</span>,</span>
<span>    <span class="va"><a href="../reference/PkParameterInfo.html">PkParameterInfo</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"MRT"</span>, <span class="st">"new_MRT"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output2</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Output.html">Output</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="st">"Organism|ArterialBlood|Plasma|Caffeine|Concentration"</span>, displayName <span class="op">=</span> <span class="st">"op2"</span>,</span>
<span>  pkParameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va"><a href="../reference/PkParameterInfo.html">PkParameterInfo</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"t_max"</span>, <span class="st">"new_t_max"</span><span class="op">)</span>,</span>
<span>    <span class="va"><a href="../reference/PkParameterInfo.html">PkParameterInfo</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"AUC_tEnd"</span>, <span class="st">"new_AUC_tEnd"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here, <code>output1</code> and <code>output2</code> are
<code>Output</code> objects. The <code>path</code> input to the
constructors of these objects gives the path to the model output. For
example, the <code>path</code> input for <code>output1</code> points to
the concentration of caffeine in lung interstitial tissue,
<code>Organism|Lung|Interstitial|Caffeine|Concentration</code>. This
model output is given the display name <code>op1</code>. The PK
parameters chosen for this example are the <code>C_max</code> and
<code>MRT</code>, which are given the display names
<code>new_C_max</code> and <code>new_MRT</code>, respectively.
Similarly, <code>output2</code> points to the model output with path
<code>Organism|ArterialBlood|Plasma|Caffeine|Concentration</code>. The
PK parameters selected for <code>output2</code> are <code>t_max</code>
and <code>AUC_tEnd</code>, for which the respective display names
<code>new_t_max</code> and <code>new_AUC_tEnd</code> will be used.</p>
<div class="section level4">
<h4 id="mean-model-workflow">Mean model workflow<a class="anchor" aria-label="anchor" href="#mean-model-workflow"></a>
</h4>
<p>The mean model workflow operates on <code>SimulationSet</code>
objects. These objects store the path to the model simulation
(<code>.pkml</code>) file as well as the <code>Output</code> objects
(described above). A descriptive name for the <code>SimulationSet</code>
object can be provided using the <code>simulationSetName</code> field of
the <code>SimulationSet</code> constructor. For the mean model workflow,
a <code>SimulationSet</code> object is created as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ms</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/SimulationSet.html">SimulationSet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  simulationSetName <span class="op">=</span> <span class="st">"simulationSet1"</span>,</span>
<span>  simulationFile <span class="op">=</span> <span class="va">simulationFile</span>,</span>
<span>  outputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">output1</span>, <span class="va">output2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>A mean model workflow object is then instantiated using the
<code>SimulationSet</code> object <code>ms</code> as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mwf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/MeanModelWorkflow.html">MeanModelWorkflow</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  simulationSets <span class="op">=</span> <span class="va">ms</span>,</span>
<span>  workflowFolder <span class="op">=</span> <span class="st">"meanSensitivityExample"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In this mean model workflow, the tasks will consist of a sensitivity
analysis followed by generation of plots of the sensitivity analysis
results. These two tasks are activated as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mwf</span><span class="op">$</span><span class="va">simulate</span><span class="op">$</span><span class="fu">activate</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mwf</span><span class="op">$</span><span class="va">calculateSensitivity</span><span class="op">$</span><span class="fu">activate</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mwf</span><span class="op">$</span><span class="va">plotSensitivity</span><span class="op">$</span><span class="fu">activate</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The model parameters to be perturbed in the sensitivity analysis are
next set:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mwf</span><span class="op">$</span><span class="va">calculateSensitivity</span><span class="op">$</span><span class="va">settings</span><span class="op">$</span><span class="va">variableParameterPaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Organism|Heart|Volume"</span>,</span>
<span>  <span class="st">"Organism|Lung|Volume"</span>,</span>
<span>  <span class="st">"Organism|Kidney|Volume"</span>,</span>
<span>  <span class="st">"Organism|Brain|Volume"</span>,</span>
<span>  <span class="st">"Organism|Muscle|Volume"</span>,</span>
<span>  <span class="st">"Organism|LargeIntestine|Volume"</span>,</span>
<span>  <span class="st">"Organism|PortalVein|Volume"</span>,</span>
<span>  <span class="st">"Organism|Spleen|Volume"</span>,</span>
<span>  <span class="st">"Organism|Skin|Volume"</span>,</span>
<span>  <span class="st">"Organism|Pancreas|Volume"</span>,</span>
<span>  <span class="st">"Organism|SmallIntestine|Mucosa|UpperIleum|Fraction mucosa"</span>,</span>
<span>  <span class="st">"Organism|SmallIntestine|Volume"</span>,</span>
<span>  <span class="st">"Organism|Lumen|Effective surface area variability factor"</span>,</span>
<span>  <span class="st">"Organism|Bone|Volume"</span>,</span>
<span>  <span class="st">"Organism|Stomach|Volume"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The properties of the sensitivity plots to be generated are set next.
The field <code>totalSensitivityThreshold</code> is used to filter out
from the sensitivity plots any model variables that contribute little to
the total sensitivity of the model. The
<code>maximalParametersPerSensitivityPlot</code> field limits the number
of model variables to be displayed in sensitivity plots. The axis font
size is set using the parameters <code>xAxisFontSize</code> and
<code>yAxisFontSize</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mwf</span><span class="op">$</span><span class="va">plotSensitivity</span><span class="op">$</span><span class="va">settings</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/SensitivityPlotSettings.html">SensitivityPlotSettings</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  totalSensitivityThreshold <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  maximalParametersPerSensitivityPlot <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  xAxisFontSize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  yAxisFontSize <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>With the <code>calculateSensitivity</code> and
<code>plotSensitivity</code> tasks now set up, the sensitivity
evaluation and plot are started with the command
<code>runWorkflow</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mwf</span><span class="op">$</span><span class="fu">runWorkflow</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The output report, containing the mean model sensitivity plots from
this example, is shown below.</p>
<details><summary><strong>Report</strong>
</summary><img src="figures/report-snapshot-70.png" style="width:100%; border-style: none;"></details>
</div>
<div class="section level4">
<h4 id="population-model-workflow">Population model workflow<a class="anchor" aria-label="anchor" href="#population-model-workflow"></a>
</h4>
<p>Unlike the mean model sensitivity analysis, a population sensitivity
analysis depends on the outcomes of the
<code>calculatePKParameters</code> task for the population. This task,
in turn, turn depends on the results of the <code>simulate</code> task
for the population. The population sensitivity analysis proceeds as
follows:</p>
<ul>
<li><p>Step 1) The model is simulated for the entire population using
the <code>simulate</code> task.</p></li>
<li><p>Step 2) Using the <code>calculatePKParameters</code> task, the PK
parameters of each user-specified model output are calculated for each
individual in the population based on their simulation results
(evaluated in Step 1). For each PK parameter, the computations in Step 2
result in a distribution of that parameter over the entire
population.</p></li>
<li><p>Step 3) The population sensitivity analysis of a PK parameter of
a model output is composed of sensitivity analyses, similar to the mean
model sensitivity analysis, conducted for a selection of individuals
within the population. The individuals chosen for the sensitivity
analysis are those with PK parameters values that lie closest to
user-specified quantiles of the pk parameter distributions computed in
Step 2.</p></li>
</ul>
<p>In this example, the sensitivity analysis will be conducted for two
populations in parallel. In the first step, the model outputs to be
analyzed are defined:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">populationOutputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">output1</span>, <span class="va">output2</span><span class="op">)</span></span></code></pre></div>
<p>Next, <code>PopulationSimulationSet</code> objects are defined for
each of the two populations:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps1</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PopulationSimulationSet.html">PopulationSimulationSet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  simulationSetName <span class="op">=</span> <span class="st">"popSimulationSet1"</span>,</span>
<span>  simulationFile <span class="op">=</span> <span class="va">simulationFile</span>,</span>
<span>  populationFile <span class="op">=</span> <span class="va">populationFile1</span>,</span>
<span>  outputs <span class="op">=</span> <span class="va">populationOutputs</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ps2</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PopulationSimulationSet.html">PopulationSimulationSet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  simulationSetName <span class="op">=</span> <span class="st">"popSimulationSet2"</span>,</span>
<span>  simulationFile <span class="op">=</span> <span class="va">simulationFile</span>,</span>
<span>  populationFile <span class="op">=</span> <span class="va">populationFile2</span>,</span>
<span>  outputs <span class="op">=</span> <span class="va">populationOutputs</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>With this setup, the sensitivity of PK parameters of
<code>output1</code> and <code>output2</code> will be analyzed for the
two populations. The two <code>PopulationSimulationSet</code> objects
are then used to create a <code>PopulationWorkflow</code>, the results
of which are to be placed in the root directory
<code>./popSensitivityExample</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pwf</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/PopulationWorkflow.html">PopulationWorkflow</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  simulationSets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ps1</span>, <span class="va">ps2</span><span class="op">)</span>,</span>
<span>  workflowFolder <span class="op">=</span> <span class="st">"popSensitivityExample"</span>,</span>
<span>  workflowType <span class="op">=</span> <span class="va">PopulationWorkflowTypes</span><span class="op">$</span><span class="va">parallelComparison</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next, the required tasks of the workflow are activated. The
sensitivity analysis and sensitivity plot tasks are activated using the
commands</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pwf</span><span class="op">$</span><span class="va">calculateSensitivity</span><span class="op">$</span><span class="fu">activate</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pwf</span><span class="op">$</span><span class="va">plotSensitivity</span><span class="op">$</span><span class="fu">activate</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The population sensitivity analysis depends on the PK parameter
calculations for the population, which in turn depend on population
simulation results. If these prerequisite tasks (<code>simulate</code>
and <code>calculatePKParameters</code>) have not previously been run,
they must also be activated:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pwf</span><span class="op">$</span><span class="va">simulate</span><span class="op">$</span><span class="fu">activate</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pwf</span><span class="op">$</span><span class="va">calculatePKParameters</span><span class="op">$</span><span class="fu">activate</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The variables to be perturbed in the sensitivity analysis are
specified as follows:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pwf</span><span class="op">$</span><span class="va">calculateSensitivity</span><span class="op">$</span><span class="va">settings</span><span class="op">$</span><span class="va">variableParameterPaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Organism|Heart|Volume"</span>,</span>
<span>  <span class="st">"Organism|Lung|Volume"</span>,</span>
<span>  <span class="st">"Organism|Kidney|Volume"</span>,</span>
<span>  <span class="st">"Organism|Brain|Volume"</span>,</span>
<span>  <span class="st">"Organism|Muscle|Volume"</span>,</span>
<span>  <span class="st">"Organism|LargeIntestine|Volume"</span>,</span>
<span>  <span class="st">"Organism|PortalVein|Volume"</span>,</span>
<span>  <span class="st">"Organism|Spleen|Volume"</span>,</span>
<span>  <span class="st">"Organism|Skin|Volume"</span>,</span>
<span>  <span class="st">"Organism|Pancreas|Volume"</span>,</span>
<span>  <span class="st">"Organism|SmallIntestine|Mucosa|UpperIleum|Fraction mucosa"</span>,</span>
<span>  <span class="st">"Organism|SmallIntestine|Volume"</span>,</span>
<span>  <span class="st">"Organism|Lumen|Effective surface area variability factor"</span>,</span>
<span>  <span class="st">"Organism|Bone|Volume"</span>,</span>
<span>  <span class="st">"Organism|Stomach|Volume"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The individuals within the population for which sensitivity will be
evaluated are those with PK parameter values (as evaluated in the
<code>calculatePKParameters</code> task) that lie closes to
user-specified quantiles of the population’s PK parameter distributions.
These quantiles are specified as follows:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pwf</span><span class="op">$</span><span class="va">calculateSensitivity</span><span class="op">$</span><span class="va">settings</span><span class="op">$</span><span class="va">quantileVec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span></span></code></pre></div>
<p>As with the mean model sensitivity plot, the population sensitivity
plot is configured using an instance of a
<code>SensitivityPlotSettings</code> object:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pwf</span><span class="op">$</span><span class="va">plotSensitivity</span><span class="op">$</span><span class="va">settings</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/SensitivityPlotSettings.html">SensitivityPlotSettings</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  totalSensitivityThreshold <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  maximalParametersPerSensitivityPlot <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  xAxisFontSize <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  yAxisFontSize <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The population sensitivity workflow is run using the command:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pwf</span><span class="op">$</span><span class="fu">runWorkflow</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The results of the population sensitivity analysis are found in
multiple <code>.csv</code> files within the
<code>SensitivityResults</code> sub-directory of the workflow folder, as
shown in the following figure:</p>
<pre><code><span><span class="co">#&gt; [1] FALSE</span></span></code></pre>
<p><img src="figures/sa-file-outputs.png" width="40%"></p>
<p>Two sets of files make up the population sensitivity analysis results
for this example, each corresponding to one of the
<code>PopulationSimulationSet</code> objects (named
<code>popSimulationSet1</code> and <code>popSimulationSet2</code>). For
each set, there is one index file. The name of the index file is
prefixed with the name of the <code>PopulationSimulationSet</code>
object and carries the suffix
<code>-popSensitivityResultsIndex.csv</code>). The index file
<code>popSimulationSet1-popSensitivityResultsIndex.csv</code> contains
the names of the individual sensitivity analysis results files (found
within the <code>SensitivityResults</code> sub-directory of the workflow
folder) obtained for the <code>PopulationSimulationSet</code> object
<code>popSimulationSet1</code>. Its contents are shown in the following
figure:</p>
<pre><code><span><span class="co">#&gt; [1] FALSE</span></span></code></pre>
<p><img src="figures/sa-file-index.png" width="100%"></p>
<p>Two output paths are shown corresponding to <code>output1</code>
(pink), <code>output2</code> (blue). Note that, as per the definitions
of <code>output1</code> and <code>output2</code>, the only PK parameters
analyzed for those two outputs are <code>C_max</code> and
<code>MRT</code> for <code>output1</code> and <code>t_max</code> and
<code>AUC_tEnd</code> for <code>output2</code>. For each model output
and PK parameter combination, there are sensitivity analysis result
files for three individuals given under the <code>Filename</code>
column, each corresponding to one of the quantiles specified using
<code>pwf$calculateSensitivity$settings$quantileVec</code>.</p>
<p>The output report, containing the population sensitivity plots from
this example, is shown below.</p>
<details><summary><strong>Report</strong>
</summary><img src="figures/report-snapshot-71.png" style="width:100%; border-style: none;"></details>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Sevestre, Juri Solodenko, Pierre Chelle, Abdullah Hamadeh.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
