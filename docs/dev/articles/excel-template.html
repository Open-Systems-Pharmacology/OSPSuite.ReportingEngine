<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ospsuite.reportingengine">
<title>Excel Template • ospsuite.reportingengine</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Excel Template">
<meta property="og:description" content="ospsuite.reportingengine">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ospsuite.reportingengine</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/ospsuite-reportingengine.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/add-title-page.html">Add a title page to your workflow report</a>
    <a class="dropdown-item" href="../articles/demography.html">Demography Parameters in Population Workflows</a>
    <a class="dropdown-item" href="../articles/excel-template.html">Excel Template</a>
    <a class="dropdown-item" href="../articles/goodness-of-fit.html">Time profiles and Residuals task</a>
    <a class="dropdown-item" href="../articles/mass-balance.html">Mass Balance</a>
    <a class="dropdown-item" href="../articles/pk-parameters.html">PK parameters</a>
    <a class="dropdown-item" href="../articles/plot-settings.html">Plot settings</a>
    <a class="dropdown-item" href="../articles/pop-pk-parameters.html">PK Parameters in Population Workflows</a>
    <a class="dropdown-item" href="../articles/qualification-workflow.html">Qualification Workflow</a>
    <a class="dropdown-item" href="../articles/sensitivity-analysis.html">Sensitivity Analysis</a>
    <a class="dropdown-item" href="../articles/word-report.html">How to work with word reports</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/open-systems-pharmacology/ospsuite.reportingengine/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Excel Template</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/open-systems-pharmacology/ospsuite.reportingengine/blob/HEAD/vignettes/excel-template.Rmd" class="external-link"><code>vignettes/excel-template.Rmd</code></a></small>
      <div class="d-none name"><code>excel-template.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/open-systems-pharmacology/ospsuite.reportingengine" class="external-link">ospsuite.reportingengine</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ospsuite.reportingengine</span></span>
<span><span class="co">#&gt; Loading required package: ospsuite</span></span>
<span><span class="co">#&gt; Loading required package: rSharp</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'ospsuite'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     %||%</span></span>
<span><span class="co">#&gt; Loading required package: tlf</span></span></code></pre></div>
<div class="section level2">
<h2 id="get-started">Get started<a class="anchor" aria-label="anchor" href="#get-started"></a>
</h2>
<div class="section level3">
<h3 id="what-for">What for ?<a class="anchor" aria-label="anchor" href="#what-for"></a>
</h3>
<p>Creating and customizing your workflow using R can be
challenging.</p>
<p>Leveraging <em>Excel</em>, you can define your workflow, all its
elements, settings and options with a few clicks.</p>
<p>The Excel template was created so that users can design their own
workflows by directly tuning a working example.</p>
</div>
<div class="section level3">
<h3 id="what-is-it">What is it ?<a class="anchor" aria-label="anchor" href="#what-is-it"></a>
</h3>
<p>The Excel template is an <em>xlsx</em> document that defines all the
relevant information of a working workflow.</p>
<p>The function <a href="../reference/createWorkflowFromExcelInput.html"><code>createWorkflowFromExcelInput()</code></a>
converts such Excel document into an R script that defines your workflow
in plain R code. Then, you can run your workflow by running the R script
(e.g. using the function <code><a href="https://rdrr.io/r/base/source.html" class="external-link">source()</a></code>).</p>
</div>
<div class="section level3">
<h3 id="where-can-i-get-the-template">Where can I get the template ?<a class="anchor" aria-label="anchor" href="#where-can-i-get-the-template"></a>
</h3>
<p>The Excel template is available through the following link <a href="templates/WorkflowInput.xlsx">WorkflowInput.xlsx</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="standard-excel-sheet-names">Standard Excel Sheet Names<a class="anchor" aria-label="anchor" href="#standard-excel-sheet-names"></a>
</h2>
<p>The Excel template includes a few standard Excel sheets that are
required for the conversion into R code.</p>
<ul>
<li><a href="#documentation">Documentation</a></li>
<li><a href="#workflow-and-tasks">Workflow and Tasks</a></li>
<li><a href="#simulationsets">SimulationSets</a></li>
<li><a href="#data-sources">Data Sources</a></li>
<li><a href="#outputs">Outputs</a></li>
<li><a href="#userdef-pk-parameter">Userdef PK Parameter</a></li>
<li><a href="#pk-parameter">PK Parameter</a></li>
<li><a href="#sensitivityparameter">SensitivityParameter</a></li>
<li><a href="#tpdictionary">tpDictionary</a></li>
</ul>
<p><a id="documentation"></a></p>
<div class="section level3">
<h3 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h3>
<p>The Excel sheet <em>Documentation</em> aims at documenting your R
script. All of its content will be added as commented text (preceded by
<code>#</code> character) in first lines of your R script.</p>
<details><summary>
Table : Documentation sheet
</summary><table class="table">
<thead><tr class="header">
<th align="left">Purpose:</th>
<th align="left">Please fill in the purpose of the script</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">M&amp;S activity:</td>
<td align="left">Please fill in the corresponding M&amp;S activity</td>
</tr>
<tr class="even">
<td align="left">Validation level:</td>
<td align="left">Please fill in the Validation level</td>
</tr>
</tbody>
</table></details><p><a id="workflow-and-tasks"></a></p>
</div>
<div class="section level3">
<h3 id="workflow-and-tasks">Workflow and Tasks<a class="anchor" aria-label="anchor" href="#workflow-and-tasks"></a>
</h3>
<p>The Excel sheet <em>Workflow and Tasks</em> defines the main
attributes of your workflow.</p>
<details><summary>
Table : Workflow and Tasks sheet
</summary><table class="table">
<colgroup>
<col width="10%">
<col width="85%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">Code Identifier</th>
<th align="left">Description</th>
<th align="left">Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Workflow Mode</td>
<td align="left">Mode of workflow. <br>- If set to MeanModelWorkflow: a
mean model workflow is created<br>- If set to PopulationWorkflow: a
population workflow is created</td>
<td align="left">MeanModelWorkflow</td>
</tr>
<tr class="even">
<td align="left">Population Workflow type</td>
<td align="left">Relevant for population workflows only</td>
<td align="left">parallelComparison</td>
</tr>
<tr class="odd">
<td align="left">workflowFolder</td>
<td align="left">Output folder of the workflow RELATIVE to workflow.R,
e.g. Report or Report/Part1 (use slash! Not backslash)</td>
<td align="left">Report</td>
</tr>
<tr class="even">
<td align="left">reportTitle</td>
<td align="left">Title included on top of the report</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">reportFileName</td>
<td align="left">Name of the report file. Remember to include Markdown
.md extension. Keep empty to use the default</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">createWordReport</td>
<td align="left">If activated: MS Word report will be created
additionally to Markdown report</td>
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">simulationSetDescriptor</td>
<td align="left">Optional alternative name for ‘simulation set’, to be
used in reports.</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">plotFormat</td>
<td align="left">Select plot format; keep empty to use the default</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Active tasks</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">simulate</td>
<td align="left">Activate workflow task “simulate”?</td>
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">calculatePKParameters</td>
<td align="left">Activate workflow task “calculatePKParameters”?</td>
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">calculateSensitivity</td>
<td align="left">Activate workflow task “calculateSensitivity”?</td>
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">plotTimeProfilesAndResiduals</td>
<td align="left">Activate workflow task
“plotTimeProfilesAndResiduals”?</td>
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">plotPKParameters</td>
<td align="left">Activate workflow task “plotPKParameters”?</td>
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">plotSensitivity</td>
<td align="left">Activate workflow task “plotSensitivity”?</td>
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">plotAbsorption</td>
<td align="left">Activate workflow task “plotAbsorption”? (relevant for
mean model workflow only)</td>
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">plotMassBalance</td>
<td align="left">Activate workflow task “plotMassBalance”? (relevant for
mean model workflow only)</td>
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">plotDemography</td>
<td align="left">Activate workflow task “plotDemography”? (relevant for
population workflow only)</td>
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">Task-specific options</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">simulate: numberOfCores</td>
<td align="left">“simulate” task: number of cores to use. Relevant for
POPULATION workflow only.<br>Leave empty to use the default value
(=number of cores -1).<br>Setting to a non-empty value&gt;1 requires MPI
(use only when running on more than 1 physical machine (e.g. cloud
etc.))</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">simulate: showProgress</td>
<td align="left">“simulate” task: show progress. Relevant for POPULATION
workflow only.</td>
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">calculateSensitivity: numberOfCores</td>
<td align="left">“calculateSensitivity” task: number of cores to
use.<br>Leave empty to use the default value (=number of cores
-1).<br>Setting to a non-empty value&gt;1 requires MPI. Use this option
only when running on more than 1 physical machine (e.g. cloud etc.)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">calculateSensitivity: showProgress</td>
<td align="left">“calculateSensitivity” task: show progress.</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">calculateSensitivity: quantileVec</td>
<td align="left">“calculateSensitivity” task: quantiles for sensitivity
analysis. Relevant for POPULATION workflow only.</td>
<td align="left">c(0.05, 0.50, 0.95)</td>
</tr>
<tr class="odd">
<td align="left">calculateSensitivity: variationRange</td>
<td align="left">“calculateSensitivity” task: Variation range (s. OSP
documentation for details). Leave empty to use the default.</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">calculateSensitivity: variableParameterPaths</td>
<td align="left">“calculateSensitivity” task: paths of parameters to
vary when performing sensitivity analysis.<br> - leave empty to
calculate sensitivity of all suitable parameters (non-categorical,
effectively used, non-zero, non-table, …)<br> - otherwise: provide sheet
name with parameter paths</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">plotSensitivity:
maximalParametersPerSensitivityPlot</td>
<td align="left">“plotSensitivity” task: maximal number of parameters to
display in a sensitivity plot. Leave empty to use the default.</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">plotSensitivity: totalSensitivityThreshold</td>
<td align="left">“plotSensitivity” task: cut-off used for plots of the
most sensitive parameters. Leave empty to use the default.</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">plotSensitivity: xAxisFontSize</td>
<td align="left">“plotSensitivity” task: font size for the X axis. Leave
empty to use the default.</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">plotSensitivity: yAxisFontSize</td>
<td align="left">“plotSensitivity” task: font size for the Y axis. Leave
empty to use the default.</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Activity specific code</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">activitySpecificCode</td>
<td align="left">Leave empty if there is no activity specific
code.<br>Otherwise: the name of the R function which will be called
directly before workflow$runWorkflow() in the generated R code.<br>This
function must be placed in the same directory as the generated R code
and must have 1 argument of the type “workflow”.<br>It can modify the
created workflow directly before execution (e.g. change options, add
user-defined tasks, …)</td>
<td align="left"></td>
</tr>
</tbody>
</table></details><p><a id="simulationsets"></a></p>
</div>
<div class="section level3">
<h3 id="simulationsets">SimulationSets<a class="anchor" aria-label="anchor" href="#simulationsets"></a>
</h3>
<p>The Excel sheet <em>SimulationSets</em> defines the simulation sets
and their properties of your workflow.</p>
<details><summary>
Table : SimulationSets sheet
</summary><table style="width:100%;" class="table">
<colgroup>
<col width="17%">
<col width="72%">
<col width="4%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">Code Identifier</th>
<th align="left">Description</th>
<th align="left">SimulationSet1</th>
<th align="left">SimulationSet2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">simulationSetName</td>
<td align="left">Unique name of the simulation set (will appear in
report)</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">simulationFile</td>
<td align="left">Path to the simulation file (pkml) RELATIVE to
workflow.R, e.g. Lysergsäurediethylamid.pkml or
Models/Lysergsäurediethylamid.pkml</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">outputs</td>
<td align="left">name of included outputs defined in Outputs sheet.
Separate outputs with a coma to include multiple outputs</td>
<td align="left">Output1, Output2</td>
<td align="left">Output1, Output2</td>
</tr>
<tr class="even">
<td align="left">dataSource</td>
<td align="left">name of included data sources defined in Data Sources
sheet</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">dataSelection</td>
<td align="left">data selection filter for nonmem data file. Allowable
inputs:<br>- ALL: all data selected<br>- NONE: no data selected<br>- If
left empty, no data are selected<br>- R readable filter: data selection
according to the filter</td>
<td align="left">ALL</td>
<td align="left">ALL</td>
</tr>
<tr class="even">
<td align="left">dataDisplayName</td>
<td align="left">display name of the observed data in report. Will be
concatenated with the output display name</td>
<td align="left">Study A</td>
<td align="left">StudyB</td>
</tr>
<tr class="odd">
<td align="left">timeUnit</td>
<td align="left">display unit for time variable</td>
<td align="left">h</td>
<td align="left">min</td>
</tr>
<tr class="even">
<td align="left">timeOffset</td>
<td align="left">simulation start offset</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">All settings below are relevant for POPULATION
workflows only</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">populationFile</td>
<td align="left">Path to the population file (csv) RELATIVE to
workflow.R, e.g. Pop.csv or Populations/Pop.csv</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">populationName</td>
<td align="left">display name of population</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">referencePopulation</td>
<td align="left">Reference population used in Pediatric and Ratio
Comparison workflows</td>
<td align="left">No</td>
<td align="left">No</td>
</tr>
<tr class="odd">
<td align="left">plotReferenceObsData</td>
<td align="left">Observed data from reference population is plotted in a
Simulation Set time profiles of Pediatric and Ratio Comparison
workflows</td>
<td align="left">No</td>
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">StudyDesignType</td>
<td align="left">S. StudyDesignLocation for explanation</td>
<td align="left">FILE</td>
<td align="left">SHEET</td>
</tr>
<tr class="odd">
<td align="left">StudyDesignLocation</td>
<td align="left">- If Empty: no study design<br>- If StudyDesignType is
set to FILE: path to the StudyDesign file RELATIVE to workflow.R,
e.g. StudyDesign.csv or Data/StudyDesign.csv<br>- If StudyDesignType is
set to SHEET: name of the sheet for study design generation<br>
</td>
<td align="left"></td>
<td align="left">StudyDesign</td>
</tr>
<tr class="even">
<td align="left">All settings below are relevant for MEANMODEL workflows
only</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">massBalanceFile</td>
<td align="left">Path to the mass balance settings (json) RELATIVE to
workflow.R, e.g. mass-balance-settings.json or
Models/mass-balance-settings.json</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table></details><p><a id="outputs"></a></p>
</div>
<div class="section level3">
<h3 id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a>
</h3>
<p>The Excel sheet <em>Outputs</em> defines the properties of each
output paths.</p>
<details><summary>
Table : Outputs sheet
</summary><table class="table">
<colgroup>
<col width="3%">
<col width="62%">
<col width="17%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="left">Code Identifier</th>
<th align="left">Description</th>
<th align="left">Output1</th>
<th align="left">Output2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">path</td>
<td align="left">output path</td>
<td align="left">Organism|PeripheralVenousBlood|C1|Plasma (Peripheral
Venous Blood)</td>
<td align="left">Organism|Lumen|C1|Fraction of oral drug mass absorbed
into mucosa</td>
</tr>
<tr class="even">
<td align="left">displayName</td>
<td align="left">label for report</td>
<td align="left">C1 plasma</td>
<td align="left">fraction absorbed</td>
</tr>
<tr class="odd">
<td align="left">displayUnit</td>
<td align="left">time profile display unit</td>
<td align="left">µg/l</td>
<td align="left">%</td>
</tr>
<tr class="even">
<td align="left">groupID</td>
<td align="left">identifier for splitting outputs by the combination
{displayUnit; groupID}. Each combination becomes then a separate
plot</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">color</td>
<td align="left">display color for lines and points in time profiles and
residual plots</td>
<td align="left">#5050FF</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">fill</td>
<td align="left">display color for ranges and histograms in time
profiles and residual plots</td>
<td align="left">#5050FF</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">dataSelection</td>
<td align="left">data selection filter for nonmem data file (will be
combined with SimSet data selection per &amp; ). Allowable inputs:<br>-
R readable filter<br>- ALL: all data selected<br>- NONE: no data
selected<br>- If left empty, no data are selected<br>- R readable
filter: data selection according to the filter</td>
<td align="left">ALL</td>
<td align="left">ALL</td>
</tr>
<tr class="even">
<td align="left">dataDisplayName</td>
<td align="left">display name of the observed data in report. Will be
appended to the observed data display name of parent simulation set</td>
<td align="left">Plasma</td>
<td align="left">Fraction Absorbed</td>
</tr>
<tr class="odd">
<td align="left">dataUnit</td>
<td align="left">unit of corresponding observed data in dataset</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">pkParameters</td>
<td align="left">Sheet name with PK parameters definition for the given
output</td>
<td align="left">PK Conc Single</td>
<td align="left">PK Fraction</td>
</tr>
</tbody>
</table></details><p>Check section <a href="#excel-outputs">How to define Output objects
?</a> for more details on how to set up observed data sets.</p>
<p><a id="data-sources"></a></p>
</div>
<div class="section level3">
<h3 id="data-sources">Data Sources<a class="anchor" aria-label="anchor" href="#data-sources"></a>
</h3>
<p>The Excel sheet <em>Data Sources</em> defines the observed data sets
and their properties.</p>
<details><summary>
Table : Data Sources sheet
</summary><table class="table">
<colgroup>
<col width="7%">
<col width="84%">
<col width="3%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">Code Identifier</th>
<th align="left">Description</th>
<th align="left">Source1</th>
<th align="left">Source2</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">dataFile</td>
<td align="left">Path to the observed data file (nonmem format) RELATIVE
to workflow.R, e.g. Raltegravir_PK.txt or Data/Raltegravir_PK.txt</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">DictionaryType</td>
<td align="left">S. DictionaryLocation for explanation</td>
<td align="left">FILE</td>
<td align="left">SHEET</td>
</tr>
<tr class="odd">
<td align="left">DictionaryLocation</td>
<td align="left">- If DictionaryType is set to FILE: path to the
dictionary file RELATIVE to workflow.R, e.g. tpDictionary.csv or
Data/tpDictionary.csv<br>- If DictionaryType is set to SHEET: name of
the sheet for dictionary generation<br>
</td>
<td align="left"></td>
<td align="left">tpDictionary</td>
</tr>
<tr class="even">
<td align="left">caption</td>
<td align="left">Displayed data source caption in the report. The
caption will be preceeded by Data source:</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table></details><p>Check section <a href="#excel-observed-datasets">How to define
observed data sets ?</a> for more details on how to set up observed data
sets.</p>
<p><a id="userdef-pk-parameter"></a></p>
</div>
<div class="section level3">
<h3 id="userdef-pk-parameter">Userdef PK Parameter<a class="anchor" aria-label="anchor" href="#userdef-pk-parameter"></a>
</h3>
<p>This standard sheet is required when user-defined PK Parameters are
calculated in your simulations.</p>
<p>Check section <a href="#excel-pk">How to define PK Parameters ?</a>
for more details on how to set up user-defined PK Parameters.</p>
<p><a id="sensitivityparameter"></a></p>
</div>
<div class="section level3">
<h3 id="sensitivityparameter">SensitivityParameter<a class="anchor" aria-label="anchor" href="#sensitivityparameter"></a>
</h3>
<p>This standard sheet is a template that can be tuned to inform which
specific input parameters you wish to vary in your sensitivity
analysis.</p>
<p>Check section <a href="#excel-sensitivity">How to set up sensitivity
analyses ?</a> for more details on how to set up the input
parameters.</p>
<p><a id="tpDictionary"></a></p>
</div>
<div class="section level3">
<h3 id="tpdictionary">tpDictionary<a class="anchor" aria-label="anchor" href="#tpdictionary"></a>
</h3>
<p>This standard sheet is a template that can be tuned to inform the
meta data of your observed datasets.</p>
<p>Check section <a href="#excel-observed-datasets">How to define
observed datasets ?</a> for more details on how to set up the dictionary
of your datasets.</p>
</div>
</div>
<div class="section level2">
<h2 id="how-to">How to ?<a class="anchor" aria-label="anchor" href="#how-to"></a>
</h2>
<p><a id="excel-outputs"></a></p>
<div class="section level3">
<h3 id="how-to-define-output-objects">How to define Output objects ?<a class="anchor" aria-label="anchor" href="#how-to-define-output-objects"></a>
</h3>
<p>To define and include Output objects in your Simulation Sets, users
only need to</p>
<p>1- Define them in the standard Excel sheet <em>Outputs</em></p>
<p>2- Declare the name of the created output(s) in the Excel sheet
<em>SimulationSets</em> in the cell corresponding to <em>outputs</em>. A
drop-down menu is available and allows you to select directly an output
defined in the sheet <em>Outputs</em>. Users can also provide multiple
outputs within the cell, however they need to be separated by a comma
(character <code>,</code>).</p>
<p><a id="excel-pk"></a></p>
</div>
<div class="section level3">
<h3 id="how-to-define-pk-parameters">How to define PK Parameters ?<a class="anchor" aria-label="anchor" href="#how-to-define-pk-parameters"></a>
</h3>
<p>To define and include PK Parameters users need to</p>
<p>1- Define them in an Excel sheet using the Excel sheet <em>PK
Parameter</em> as reference (<em>PK Conc Single</em>, <em>PK Conc
Multi</em> and <em>PK Fraction</em> can also be used as reference)</p>
<details><summary>
Table : PK Parameter template sheet
</summary><table class="table">
<colgroup>
<col width="44%">
<col width="41%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left">Name</th>
<th align="left">Display name</th>
<th align="left">Unit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">C_max</td>
<td align="left">C max</td>
<td align="left">µg/l</td>
</tr>
<tr class="even">
<td align="left">C_max_norm</td>
<td align="left">C max norm</td>
<td align="left">kg/l</td>
</tr>
<tr class="odd">
<td align="left">t_max</td>
<td align="left">T max</td>
<td align="left">h</td>
</tr>
<tr class="even">
<td align="left">C_tEnd</td>
<td align="left">C End</td>
<td align="left">µg/l</td>
</tr>
<tr class="odd">
<td align="left">AUC_tEnd</td>
<td align="left">AUC</td>
<td align="left">µg*h/l</td>
</tr>
<tr class="even">
<td align="left">AUC_tEnd_norm</td>
<td align="left">AUC norm</td>
<td align="left">kg*h/l</td>
</tr>
<tr class="odd">
<td align="left">AUC_inf</td>
<td align="left">AUC inf</td>
<td align="left">µg*h/l</td>
</tr>
<tr class="even">
<td align="left">AUC_inf_norm</td>
<td align="left">AUC inf norm</td>
<td align="left">kg*h/l</td>
</tr>
<tr class="odd">
<td align="left">MRT</td>
<td align="left">MRT</td>
<td align="left">h</td>
</tr>
<tr class="even">
<td align="left">Thalf</td>
<td align="left">Thalf</td>
<td align="left">h</td>
</tr>
<tr class="odd">
<td align="left">CL</td>
<td align="left">CL</td>
<td align="left">ml/min/kg</td>
</tr>
<tr class="even">
<td align="left">Vss</td>
<td align="left">Vss</td>
<td align="left">ml/kg</td>
</tr>
<tr class="odd">
<td align="left">Vd</td>
<td align="left">Vd</td>
<td align="left">ml/kg</td>
</tr>
<tr class="even">
<td align="left">C_max_tD1_tD2</td>
<td align="left">C_max_t1_t2</td>
<td align="left">µg/l</td>
</tr>
<tr class="odd">
<td align="left">C_max_tD1_tD2_norm</td>
<td align="left">C_max_t1_t2_norm</td>
<td align="left">kg/l</td>
</tr>
<tr class="even">
<td align="left">C_max_tDLast_tEnd</td>
<td align="left">C_max_tLast_tEnd</td>
<td align="left">µg/l</td>
</tr>
<tr class="odd">
<td align="left">C_max_tDLast_tEnd_norm</td>
<td align="left">C_max_tLast_tEnd_norm</td>
<td align="left">kg/l</td>
</tr>
<tr class="even">
<td align="left">t_max_tD1_tD2</td>
<td align="left">t_max_t1_t2</td>
<td align="left">h</td>
</tr>
<tr class="odd">
<td align="left">t_max_tDLast_tEnd</td>
<td align="left">t_max_tLast_tEnd</td>
<td align="left">h</td>
</tr>
<tr class="even">
<td align="left">C_trough_tD2</td>
<td align="left">C_trough_t2</td>
<td align="left">µg/l</td>
</tr>
<tr class="odd">
<td align="left">C_trough_tDLast</td>
<td align="left">C_trough_tLast</td>
<td align="left">µg/l</td>
</tr>
<tr class="even">
<td align="left">AUC_tD1_tD2</td>
<td align="left">AUC_t1_t2</td>
<td align="left">µg*h/l</td>
</tr>
<tr class="odd">
<td align="left">AUC_tD1_tD2_norm</td>
<td align="left">AUC_t1_t2_norm</td>
<td align="left">kg*h/l</td>
</tr>
<tr class="even">
<td align="left">AUC_tDLast_minus_1_tDLast</td>
<td align="left">AUC_tLast_minus_1_tLast</td>
<td align="left">µg*h/l</td>
</tr>
<tr class="odd">
<td align="left">AUC_tDLast_minus_1_tDLast_norm</td>
<td align="left">AUC_tLast_minus_1_tLast_norm</td>
<td align="left">kg*h/l</td>
</tr>
<tr class="even">
<td align="left">AUC_inf_tD1</td>
<td align="left">AUC_inf_t1</td>
<td align="left">µg*h/l</td>
</tr>
<tr class="odd">
<td align="left">AUC_inf_tD1_norm</td>
<td align="left">AUC_inf_t1_norm</td>
<td align="left">kg*h/l</td>
</tr>
<tr class="even">
<td align="left">AUC_inf_tDLast</td>
<td align="left">AUC_inf_tLast</td>
<td align="left">µg*h/l</td>
</tr>
<tr class="odd">
<td align="left">AUC_inf_tDLast_norm</td>
<td align="left">AUC_inf_tLast_norm</td>
<td align="left">kg*h/l</td>
</tr>
<tr class="even">
<td align="left">Thalf_tDLast_tEnd</td>
<td align="left">Thalf_tLast_tEnd</td>
<td align="left">h</td>
</tr>
<tr class="odd">
<td align="left">F_tEnd</td>
<td align="left">F_tEnd</td>
<td align="left">%</td>
</tr>
<tr class="even">
<td align="left">F_max</td>
<td align="left">F_max</td>
<td align="left">%</td>
</tr>
</tbody>
</table></details><p>2- Declare the name of the created sheet in the Excel sheet of your
Output object in the cell corresponding to <em>pkParameters</em></p>
<div class="section level4">
<h4 id="user-defined-pk-parameters">User-defined PK Parameters<a class="anchor" aria-label="anchor" href="#user-defined-pk-parameters"></a>
</h4>
<p>One additional sheet is required for user-defined PK Parameters. Use
the standard Excel sheet <em>Userdef PK Parameter</em> to define your
own user-defined PK Parameter and include the names of the parameters in
your PK Parameters sheet.</p>
<p><a id="excel-observed-datasets"></a></p>
</div>
</div>
<div class="section level3">
<h3 id="how-to-define-observed-data-sets">How to define observed data sets ?<a class="anchor" aria-label="anchor" href="#how-to-define-observed-data-sets"></a>
</h3>
<p>Observed data sets are managed using <code>DataSource</code>
objects.</p>
<p>To define and include observed data users need to</p>
<p>1- Define them in the standard Excel sheet <em>Data Sources</em></p>
<p>2- Declare the name of the sources in the standard Excel sheet
<em>SimulationSet</em> within the cell corresponding to
<em>dataSource</em>. A drop-down menu is available and allows you to
select directly a data source defined in the sheet <em>Data
Sources</em>. Users can only provide a unique dataSource within the
corresponding cell.</p>
<p><code>DataSource</code> objects require a <code>metaDataFile</code>
defining the content of the observed dataset. This meta data can be
provided either by using an Excel sheet of your Excel document or by
using a separate csv file.</p>
<ul>
<li>If dictionary is defined as an Excel sheet:
<ul>
<li>Go to the standard Excel sheet <em>Data Sources</em>
</li>
<li>Select the option <strong>SHEET</strong> in the cell corresponding
to your <strong>DictionaryType</strong>
</li>
<li>Include the name of the sheet in the cell corresponding to
<strong>DictionaryLocation</strong> <br> You can use the Excel sheet
<em>tpDictionary</em> as reference</li>
</ul>
</li>
<li>If dictionary is defined as a separate csv file:
<ul>
<li>Go to the standard Excel sheet <em>Data Sources</em>
</li>
<li>Select the option <strong>FILE</strong> in the cell corresponding to
your <strong>DictionaryType</strong>
</li>
<li>Include the path of the file in the cell corresponding to
<strong>DictionaryLocation</strong> <br> You can download and use the
template <a href="templates/tpDictionary.csv">tpDictionary.csv</a> as
reference</li>
</ul>
</li>
</ul>
<p><a id="excel-sensitivity"></a></p>
</div>
<div class="section level3">
<h3 id="how-to-set-up-sensitivity-analyses">How to set up sensitivity analyses ?<a class="anchor" aria-label="anchor" href="#how-to-set-up-sensitivity-analyses"></a>
</h3>
<p>Because sensitivity analyses calculate and display the relative
impact of selected - or all - input parameters on the PK parameters of
those selected output curves, they can be performed and displayed in
many ways</p>
<p>For such reason, workflows provide a lot of options and settings that
will help you design the specific analysis you wish to perform.</p>
<p>To include a sensitivity analysis in your workflow report, you need
to activate the following tasks: <strong>simulate</strong>,
<strong>calculatePKParameters</strong>,
<strong>calculateSensitivity</strong>, and
<strong>plotSensitivity</strong>.</p>
<p>To activate these tasks, go to the standard Excel sheet <em>Workflow
and Tasks</em> and set the Values of the corresponding cells to
<strong>Yes</strong>.</p>
<p>In the same Excel sheet, you will find many options for your
sensitivity analysis under the section <em>Task-specific
options</em>.</p>
<p>The first set of options are related to the calculation of the
sensitivity.</p>
<p>In these options, you can set up the variation range of all or
selected input parameters. This range defines the amplitude of the
variations/perturbations applied around the value in the simulation. For
more details about the variation range, you can check the <a href="https://docs.open-systems-pharmacology.org/shared-tools-and-example-workflows/sensitivity-analysis" class="external-link">OSP
Suite documentation</a> on sensitivity analysis.</p>
<p>Another option is the selection of specific input parameters on which
applying the variations. To include only selected input parameters users
need to</p>
<p>1- Define them in an Excel sheet using the Excel sheet
<em>SensitivityParameter</em> as reference</p>
<details><summary>
Table : SensitivityParameter template sheet
</summary><table class="table">
<thead><tr class="header">
<th align="left">Path</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">C1|Lipophilicity</td>
</tr>
<tr class="even">
<td align="left">C1|Specific intestinal permeability
(transcellular)</td>
</tr>
</tbody>
</table></details><p>2- Declare the name of the created sheet in the standard Excel sheet
<em>Workflow and Tasks</em> in the cell corresponding to
<em>calculateSensitivity: variableParameterPaths</em></p>
<p>The second set of options are related to the sensitivity plots and
helps you defining how many input parameters are displayed and how they
are displayed.</p>
</div>
<div class="section level3">
<h3 id="how-add-a-study-design-table">How add a Study Design table ?<a class="anchor" aria-label="anchor" href="#how-add-a-study-design-table"></a>
</h3>
<p>It is possible to add a special parameters variation which is not
exported in your initial population by including a StudyDesign table to
your workflow.</p>
<p>To define Study Design tables users can either leverage an Excel
sheet of the Excel document or they can use a separate csv file.</p>
<ul>
<li>If the Study Design is defined as an Excel sheet:
<ul>
<li>Go to the standard Excel sheet <em>SimulationSets</em>
</li>
<li>Select the option <strong>SHEET</strong> in the cell corresponding
to your <strong>StudyDesignType</strong>
</li>
<li>Include the name of the sheet in the cell corresponding to
<strong>StudyDesignLocation</strong> <br> You can use the Excel sheet
<em>StudyDesign</em> as reference</li>
</ul>
</li>
<li>If Study Design is defined as a separate csv file:
<ul>
<li>Go to the standard Excel sheet <em>SimulationSets</em>
</li>
<li>Select the option <strong>FILE</strong> in the cell corresponding to
your <strong>StudyDesignType</strong>
</li>
<li>Include the path of the file in the cell corresponding to
<strong>StudyDesignLocation</strong> <br> You can download and use the
template <a href="templates/StudyDesign.csv">StudyDesign.csv</a> as
reference</li>
</ul>
</li>
</ul>
<details><summary>
Table : StudyDesign sheet
</summary><pre><code><span><span class="co">#&gt; New names:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `Organism|Weight` -&gt; `Organism|Weight...1`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> `Organism|Weight` -&gt; `Organism|Weight...2`</span></span></code></pre>
<table class="table">
<colgroup>
<col width="23%">
<col width="23%">
<col width="13%">
<col width="39%">
</colgroup>
<thead><tr class="header">
<th align="left">Organism|Weight…1</th>
<th align="left">Organism|Weight…2</th>
<th align="left">Gender</th>
<th align="left">Applications|IV Bolus|DrugMass</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">kg</td>
<td align="left">kg</td>
<td align="left"></td>
<td align="left">nmol</td>
</tr>
<tr class="even">
<td align="left">SOURCE_MIN</td>
<td align="left">SOURCE_MAX</td>
<td align="left">SOURCE_EQUALS</td>
<td align="left">TARGET</td>
</tr>
<tr class="odd">
<td align="left">20</td>
<td align="left">40</td>
<td align="left">MALE</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">20</td>
<td align="left">40</td>
<td align="left">FEMALE</td>
<td align="left">2.5</td>
</tr>
<tr class="odd">
<td align="left">40</td>
<td align="left">60</td>
<td align="left">MALE</td>
<td align="left">10</td>
</tr>
<tr class="even">
<td align="left">40</td>
<td align="left">60</td>
<td align="left">FEMALE</td>
<td align="left">14</td>
</tr>
<tr class="odd">
<td align="left">60</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">20</td>
</tr>
</tbody>
</table></details>
</div>
<div class="section level3">
<h3 id="how-to-include-your-own-code">How to include your own code ?<a class="anchor" aria-label="anchor" href="#how-to-include-your-own-code"></a>
</h3>
<p>Workflows can be updated by a user-defined function before execution
(e.g. change options, add user-defined tasks, …) by including the
function call before the line <code>workflow$runWorkflow()</code> in
your R script.</p>
<p>To do so, in the standard Excel sheet <em>Workflow and Tasks</em>,
you can include in the cell corresponding to
<strong>activitySpecificCode</strong> the name of the R function.</p>
<p>Note that this function must be placed in the same directory as the
generated R code and <strong>must have 1 argument of the type
<code>"workflow"</code></strong>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Sevestre, Juri Solodenko, Pierre Chelle, Abdullah Hamadeh.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
